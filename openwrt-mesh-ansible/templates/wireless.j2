# Wireless configuration for {{ inventory_hostname }}
# Generated by Ansible - DO NOT EDIT MANUALLY

config wifi-device 'radio0'
	option type 'mac80211'
	option path 'platform/soc/1e140000.pcie/pci0000:00/0000:00:01.0/0000:01:00.0'
	option channel '{{ mesh_channel }}'
	option band '2g'
	option htmode '{{ mesh_htmode }}'
	option country '{{ client_country }}'
	option cell_density '0'

# 2.4GHz Mesh Backup
config wifi-iface 'mesh0'
	option device 'radio0'
	option mode 'mesh'
	option network 'bat0_hardif_mesh0'
	option mesh_id '{{ mesh_id }}'
	option mesh_fwding '0'
	option mesh_ttl '1'
	option encryption '{{ mesh_encryption }}'
	option key '{{ mesh_password }}'
	option mcast_rate '{{ mesh_mcast_rate }}'

{% if enable_vlans and vlans.management is defined %}
# 2.4GHz Management AP (VLAN {{ vlans.management.vid }})
config wifi-iface 'mgmt0'
	option device 'radio0'
	option mode 'ap'
	option network 'management_bridge'
	option ssid '{{ vlans.management.ssid }}'
	option encryption '{{ vlans.management.encryption }}'
	option key '{{ vlans.management.password }}'
{% endif %}

config wifi-device 'radio1'
	option type 'mac80211'
	option path 'platform/soc/1e140000.pcie/pci0000:00/0000:00:00.0/0000:00:00.0'
	option channel '{{ client_channel }}'
	option band '5g'
	option htmode '{{ client_htmode }}'
	option country '{{ client_country }}'
	option cell_density '0'

# 5GHz Internal/Trusted AP (Main LAN)
config wifi-iface 'wlan0'
	option device 'radio1'
	option mode 'ap'
	option network 'lan'
	option ssid '{{ client_ssid }}'
	option encryption '{{ client_encryption }}'
	option key '{{ client_password }}'
{% if enable_80211r %}
	option ieee80211r '1'
	option mobility_domain '{{ mobility_domain }}'
	option ft_over_ds '1'
	option ft_psk_generate_local '1'
	option rsn_preauth '1'
{% endif %}

{% if enable_vlans and vlans.guest is defined %}
# 5GHz Guest AP (VLAN {{ vlans.guest.vid }} - Isolated)
config wifi-iface 'guest0'
	option device 'radio1'
	option mode 'ap'
	option network 'guest_bridge'
	option ssid '{{ vlans.guest.ssid }}'
	option encryption '{{ vlans.guest.encryption }}'
	option key '{{ vlans.guest.password }}'
	option isolate '1'
{% endif %}
